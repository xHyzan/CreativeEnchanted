-----------------------------------------------------------------------------------------------------------------------------------------
-- VRP
-----------------------------------------------------------------------------------------------------------------------------------------
local Tunnel = module("vrp","lib/Tunnel")
-----------------------------------------------------------------------------------------------------------------------------------------
-- CONNECTION
-----------------------------------------------------------------------------------------------------------------------------------------
vSERVER = Tunnel.getInterface("pause")
-----------------------------------------------------------------------------------------------------------------------------------------
-- VARIABLES
-----------------------------------------------------------------------------------------------------------------------------------------
local Pause = false
local SalaryTick = 0
local Cooldown = GetGameTimer()
local SalaryCooldown = GetGameTimer() + 60000
-----------------------------------------------------------------------------------------------------------------------------------------
-- THREADSALARY
-----------------------------------------------------------------------------------------------------------------------------------------
CreateThread(function()
	while true do
		local Ped = PlayerPedId()
		if LocalPlayer.state.Active and GetEntityHealth(Ped) > 100 and not LocalPlayer.state.Arena and SalaryCooldown < GetGameTimer() then
			Salarys = GetGameTimer() + 60000
			SalaryTick = SalaryTick + 1

			if SalaryTick > 30 then
				SalaryTick = 0
				vSERVER.Salarys()
			end
		end

		Wait(30000)
	end
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- COMMAND
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterCommand("PauseBreak",function()
	if not LocalPlayer.state.Arena and not exports["lb-phone"]:IsOpen() and not Pause and not IsPauseMenuActive() and Cooldown < GetGameTimer() then
		Pause = true
		SetNuiFocus(true,true)
		TransitionToBlurred(1000)
		SetCursorLocation(0.5,0.5)
		Cooldown = GetGameTimer() + 5000
		SendNUIMessage({ Action = "Open" })
		TriggerEvent("hud:Active",false)
	end
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- CLOSE
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("Close",function(Data,Callback)
	Pause = false
	SetNuiFocus(false,false)
	TransitionFromBlurred(1000)
	TriggerEvent("hud:Active",true)

	Callback("Ok")
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- SKINS
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("Skinweapon",function(Data,Callback)
	Pause = false
	SetNuiFocus(false,false)
	TransitionFromBlurred(1000)
	TriggerEvent("hud:Active",true)
	TriggerEvent("skinweapon:Open")

	Callback("Ok")
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- COMMAND
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterCommand("ActiveMap",function()
	ActivateFrontendMenu("FE_MENU_VERSION_MP_PAUSE",0,-1)
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- KEYMAPPING
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterKeyMapping("PauseBreak","Abrir as configurações","keyboard","Escape")
RegisterKeyMapping("ActiveMap","Abrir o mapa","keyboard","P")
-----------------------------------------------------------------------------------------------------------------------------------------
-- DISCONNECT
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("Disconnect",function(Data,Callback)
	vSERVER.Disconnect()

	Callback("Ok")
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- CONFIG
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("Config",function(Data,Callback)
	Callback(vSERVER.Config())
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- SETTINGS
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("Settings",function(Data,Callback)
	Pause = false
	SetNuiFocus(false,false)
	TransitionFromBlurred(1000)
	TriggerEvent("hud:Active",true)
	ActivateFrontendMenu("FE_MENU_VERSION_LANDING_MENU",0,-1)

	Callback("Ok")
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- MAP
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("Map",function(Data,Callback)
	Pause = false
	SetNuiFocus(false,false)
	TransitionFromBlurred(1000)
	TriggerEvent("hud:Active",true)
	ActivateFrontendMenu("FE_MENU_VERSION_MP_PAUSE",0,-1)

	Callback("Ok")
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- PROPERTYS
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("Propertys",function(Data,Callback)
	Callback(vSERVER.Propertys())
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- PROPERTYBUY
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("PropertyBuy",function(Data,Callback)
	Callback(vSERVER.PropertyBuy(Data.Index))
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- PROPERTYWAYPOINT
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("PropertyWaypoint",function(Data,Callback)
	SetNewWaypoint(Propertys[Data.Index].Coords.x + 0.0001,Propertys[Data.Index].Coords.y + 0.0001)
	SendNUIMessage({ Action = "Notify", Payload = { "Sucesso","Propriedade marcada.","verde" } })

	Callback("Ok")
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- PREMIUM
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("Premium",function(Data,Callback)
	Callback(vSERVER.Premium())
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- PREMIUMBUY
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("PremiumBuy",function(Data,Callback)
	Callback(vSERVER.PremiumBuy(Data.Index,Data.Selectables))
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- HOME
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("Home",function(Data,Callback)
	Callback(vSERVER.Home())
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- STORESBUY
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("StoreBuy",function(Data,Callback)
	if not LocalPlayer.state.Prison then
		Callback(vSERVER.StoreBuy(Data.Index,Data.Amount))
	else
		Callback(false)
	end
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- BATTLEPASS
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("Battlepass",function(Data,Callback)
	Callback(vSERVER.Battlepass())
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- BATTLEPASSBUY
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("BattlepassBuy",function(Data,Callback)
	Callback(vSERVER.BattlepassBuy())
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- BATTLEPASSRESCUE
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("BattlepassRescue",function(Data,Callback)
	if not LocalPlayer.state.Prison then
		Callback(vSERVER.BattlepassRescue(Data.Mode,Data.Number))
	else
		Callback(false)
	end
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- OPENBOX
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("OpenBox",function(Data,Callback)
	Callback(vSERVER.OpenBox(Data.Index))
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- MARKETPLACE
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("Marketplace",function(Data,Callback)
	Callback(vSERVER.Marketplace())
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- MARKETPLACEINVENTORY
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("MarketplaceInventory",function(Data,Callback)
	Callback(vSERVER.MarketplaceInventory(Data.Mode))
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- MARKETPLACEANNOUNCE
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("MarketplaceAnnounce",function(Data,Callback)
	Callback(vSERVER.MarketplaceAnnounce(Data))
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- MARKETPLACEBUY
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("MarketplaceBuy",function(Data,Callback)
	Callback(vSERVER.MarketplaceBuy(Data.Index))
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- MARKETPLACECANCEL
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("MarketplaceCancel",function(Data,Callback)
	Callback(vSERVER.MarketplaceCancel(Data.Index))
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- RANKING
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("Ranking",function(Data,Callback)
	Callback(vSERVER.Ranking(Data.Column,Data.Direction))
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- DAILY
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("Daily",function(Data,Callback)
	Callback(vSERVER.Daily())
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- DAILYRESCUE
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("DailyRescue",function(Data,Callback)
	Callback(vSERVER.DailyRescue(Data.Day))
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- CODE
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("Code",function(Data,Callback)
	Callback(vSERVER.Code(Data.Code))
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- PAUSE:NOTIFY
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNetEvent("pause:Notify")
AddEventHandler("pause:Notify",function(Title,Message,Type)
	SendNUIMessage({ Action = "Notify", Payload = { Title,Message,Type } })
end)